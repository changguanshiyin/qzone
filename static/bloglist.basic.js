var PAGE_EVENT={EVENT_LIST:[],fireEvent:function(e,t){var i=[],a=QZFL.lang.arg2arr(arguments).slice(1),o=false;for(var n=0;n<this.EVENT_LIST.length;n++){var r=this.EVENT_LIST[n];if(r["event"]==e&&r["handler"]){i.push(r["handler"].apply(this,a));this.EVENT_LIST[n].fired=true;this.EVENT_LIST[n].args=a;o=true}}if(!o){this.EVENT_LIST.push({handler:null,event:e,fired:true,args:a})}if(!i.length){return null}return i},addEvent:function(e,t){if(e==""||!t){throw"event params error"}this.EVENT_LIST.push({handler:t,event:e});return this},triggerEvent:function(e,t){for(var i=0;i<this.EVENT_LIST.length;i++){var a=this.EVENT_LIST[i];if(a["event"]==e&&a.fired==true){t.apply(this,a.args);return-1}}return this.addEvent(e,t)},removeEvent:function(e,t){for(var i=0;i<this.EVENT_LIST.length;i++){if(this.EVENT_LIST[i]&&this.EVENT_LIST[i]["event"]==e){var a=this.EVENT_LIST[i]["handler"];if(!t){this.EVENT_LIST[i]=null}else if(t==a){this.EVENT_LIST[i]=null}}}}};var PAGE_ROUTER={_historyList:[],
get:function(e,t){var i=location.hash;var a=new RegExp("(#|&)"+e+"=([^&#]*)(&|#|$)");var o=i.match(a);return o?o[2]:t},getAll:function(){var e=new Object;var t=location.hash.substring(1);var i=t.split("&");for(var a=0;a<i.length;a++){var o=i[a].indexOf("=");if(o==-1)continue;var n=i[a].substring(0,o);var r=i[a].substring(o+1);e[n]=r}return e},set:function(e,t){var i=location.hash;var a={};if(typeof e!="object"){a[e]=t}else{a=e}for(var o in a){var n=a[o];if(n===null||n===undefined){continue}var r=new RegExp("(#|&)"+o+"=([^&#]*)(&|#|$)");var l=i.match(r);if(l){var s=new RegExp("(#|&)"+o+"=([^&#]*)");i=i.replace(s,"")}i+=(i.indexOf("#")>=0?"&":"#")+o+"="+n}if(!frameElement){var g=document.title;location.hash=i;document.title=g}else{location.hash=i}this.addUserHistory(e,t)},addUserHistory:function(e,t){},clean:function(){var e=document.title;location.hash="#nojump=1";document.title=e;return this}};var PAGE_CACHE={namespace:"",BLOG_CACHE_MASTER_KEY:"QZONE_BLOG_CACHE_MANAGER",
BLOG_CACHE_KEY_LIST:"QZONE_BLOG_CACHE_MANAGER_KEY_LIST",CACHE_WIN:QZONE.FP._t,setNameSpace:function(e){this.namespace=e},add:function(e,t,i){return this.set(e,t,i)},set:function(e,t,i){try{e=this.namespace+e;if(!this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY]){this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY]={};this.CACHE_WIN[this.BLOG_CACHE_KEY_LIST]={}}this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY][e]={data:t,expired:parseInt(i,10)*1e3+(new Date).getTime()};this.CACHE_WIN[this.BLOG_CACHE_KEY_LIST][e]=true;return true}catch(e){return false}},get:function(e){try{e=this.namespace+e;var t=QZONE.FP._t[this.BLOG_CACHE_MASTER_KEY][e];if(t){if(!t.expired||t.expired<0){return t.data}else{var i=(new Date).getTime();if(t.expired>i){return t.data}else{this.remove(e);return null}}}}catch(e){}return null},remove:function(e){try{e=this.namespace+e;this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY][e]=undefined}catch(e){QZFL.console.print("ex")}},clean:function(e){if(e){this.remove(e)}else{try{
this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY]=undefined}catch(e){QZFL.console.print("ex")}}}};window.BlogListReporter||(window.BlogListReporter={markPoint:function(){}});(function(){if(window.BlogList){throw"BlogList ALREADY DEFINED"}PAGE_CACHE.setNameSpace("BLOGLIST_");window.BlogList={inited:false,isOwner:QZBlog.Logic.SpaceHostInfo.isOwnerMode(),data:INIT_PAGE_DATA,fixAbstract:_fixAbstract,long2shorttime:_long2shorttime,Config:{pageSize:{0:15,1:15},blogListCacheTime:20,blogReadInfoCacheTime:30},defaultFilter:{},currentFilter:{},init:function(){var e=this;e.defaultFilter={page:1,cateHex:null,cateName:null,sortType:parent.BlogListNavigator.getSortType()||0,viewmode:parseInt(INIT_PAGE_DATA.hostFlag,10)==1?1:0,startTime:null,endTime:null};if(!!parent.BlogListNavigator.getCurrentDate()){var t=parent.BlogListNavigator.getCurrentDate();var i=parent.BlogListNavigator.getCurrentCate();var a=QZBlog.Util.getMonthSpanTime(parseInt(t["year"],10),parseInt(t["month"],10));startTime=a["start"]
;endTime=a["end"];e.defaultFilter.statYear=parseInt(t["year"]);e.defaultFilter.startTime=startTime;e.defaultFilter.endTime=endTime}if(!!parent.BlogListNavigator.getCurrentCate()){e.defaultFilter.cateName=parent.BlogListNavigator.getCurrentCate();e.defaultFilter.cateHex=parent.BlogListNavigator.getCurrentCatehex()}e.currentFilter=QZFL.object.extend(true,{},e.defaultFilter);e.bindPageEvent();e.updateBasicPageView();if(PAGE_CATALOG=="list"){e.showPage({page:parseInt(getParameter("page"),10)||1})}e.inited=!QZBlog.Logic.isSeoPage;e.updateAvatar();e.showHelpTips();e.showAd($("side_ad"));e.showBottomVipAd();e.fireEvent("coreinited");e.clickTrack();PAGE_ROUTER.addUserHistory=function(e,t){if(QZONE.FP.appendHash&&!QZBlog.Logic.isSeoPage){if(typeof e=="object"&&e.catalog){QZONE.FP.appendHash(2,"catalog_"+e.catalog)}else if(e=="catalog"&&t){QZONE.FP.appendHash(2,"catalog_"+t)}}};PAGE_ROUTER.set("catalog",PAGE_CATALOG);var o=$e("a").elements[0];if(o){o.focus()}},clickTrack:function(){
var e="QZONE_BLOG_CLICK_TRACK";if(parent[e]===undefined){parent[e]=Math.random()<1e-4}if(parent[e]){setTimeout(function(){var e=document.createElement("script");e.src="http://qzonestyle.gtimg.cn/qzone/app/tracer/lib/yom/require/require-built.js";e.setAttribute("data-main","http://qzonestyle.gtimg.cn/qzone/app/tracer/tracer/main-built.js");e.setAttribute("data-param","bid=1&pid=1");document.body.appendChild(e)},1e3)}},showAd:function(e){if(!e||QZBlog.Logic.isInPengyou){return}QZBlog.Util.loadQBossAd("2189",function(t,i){e.style.display="";e.innerHTML=t;$e("a",e).onClick(function(){QZBlog.Util.reportQBossState(i.bosstrace,3)});QZBlog.Logic.TCISDClick.batchBind({".showInVip a":"sidead.vipAd",".showInNoVip a":"sidead.noVipAd"},{url:"/BlogList",container:e})})},_bottomAdDataCache:null,showBottomVipAd:function(){if(QZBlog.Logic.isInPengyou){return}var e=this;var t=function(){if(!!$("vipBottomAdContainer")){QZFL.css.addClassName($("vipBottomAdContainer"),"none")}};QZBlog.Logic.batchDelegate({
"a[rel=draft-list-link]":t,"a[rel=setting-link]":t});var i=function(e){if(!$("vipBottomAdContainer")){var t=$e("#app_mod_blog .main").elements[0];if(!t){return}QZFL.dom.createElementIn("div",t,false,{id:"vipBottomAdContainer"})}QZFL.css.removeClassName($("vipBottomAdContainer"),"none");$("vipBottomAdContainer").innerHTML=e.html;var i=$e("#blogPrivilegeAd span").elements[0];if(!!i){i.className=!!QZONE.FP.isVipUser(true)?"ico_vip_renew":"ico_vip_open"}};BlogList.triggerEvent("showpage",function(){if(!e._bottomAdDataCache){var t=new QZFL.JSONGetter("http://"+parent.siDomain+"/qzone/newblog/recommend/vip_recommend.js",void 0,null,"utf-8");t.onSuccess=function(t){
t.html='<div id="blogPrivilegeAd" class="mod_privilege bor2"><div class="hd bg"><a href="http://pay.qq.com/qzone/index.shtml?cm=tenpay&aid=zone.rzhztq" target="_blank"><span class="ico_vip_renew"><i>续费黄钻</i></span></a><span class="guide_info bg">尊享日志特权功能</span></div><div class="bd"><ul><li class="rbor2" style="padding: 5px 34px;"><a href="http://rc.qzone.qq.com/blog/add" target="_blank" static="button1" title="附件上传"><img src="/qzone/newblog/recommend/pic_1_4.jpg" alt="附件上传"><span class="privilege_wrap"><span class="privilege_tit c_tx2">附件上传</span><span class="privilege_info c_tx3" title="网盘分享更便捷">网盘分享更便捷</span></span></a></li><li class="rbor2" style="padding: 5px 34px;"><a href="http://vip.qzone.com/all_priv_pages/4-7.html" target="_blank" static="button2" title="动态信纸"><img src="/qzone/newblog/recommend/pic_2_4.jpg" alt="动态信纸"><span class="privilege_wrap"><span class="privilege_tit c_tx2">动态信纸</span><span class="privilege_info c_tx3" title="灵动变现秀心情">灵动变现秀心情</span></span></a></li><li style="padding: 5px 34px;"><a href="http://rc.qzone.qq.com/blog/addtemplateblog" target="_blank" static="button4" title="模板背景"><img src="/qzone/newblog/recommend/pic_4_4.jpg" alt="模板背景"><span class="privilege_wrap"><span class="privilege_tit c_tx2">模板背景</span><span class="privilege_info c_tx3" title="更多模板秀个性">更多模板秀个性</span></span></a></li></ul></div></div>'
;e._bottomAdDataCache=t;i(QZFL.lang.objectClone(e._bottomAdDataCache))};t.send("_Callback");t.onError=function(){}}else{i(QZFL.lang.objectClone(e._bottomAdDataCache))}})},showHelpTips:function(){var e=this;$e(".blog_import .icon_help").onHover(function(){var e,t=this;$e(".blog_import .icon_help").each(function(i,a){if(i===t){e=a}});$e(".blog_import .bubble_wrap:eq("+e+")").removeClass("none")},function(e){$e(".blog_import .bubble_wrap").addClass("none")})},showBlogDetail:function(e){var t=e.getAttribute("blogid");var i={blogId:t,page:this.currentFilter.page,refererurl:location.href};if(!this.isOwner){try{var a=parent.g_XDoc&&parent.g_XDoc["blogCommentCount"]?parent.g_XDoc["blogCommentCount"]:{};if(a&&a[t]){a[t].read++}var o=PAGE_CACHE.get("blog_read_num_"+t);PAGE_CACHE.add("blog_read_num_"+t,o+1)}catch(e){QZFL.console.print("showBlogDetail rd num:"+e)}}else{PAGE_CACHE.clean()}QZBlog.Router.redirectTo("blogcontent",i)},updateBasicPageView:function(){if($("blog-top-nav")){
$("blog-top-nav").style.display=""}if(!this.isOwner){$e("a[rel=blog-list-link]").elements[0].href="http://user.qzone.qq.com/"+QZBlog.Logic.SpaceHostInfo.getUin()+"/blog"}},updateAvatar:function(){$e("img.current-space-avatar").each(function(e){if(e.src){return}var t="avatar_"+QZBlog.Logic.SpaceHostInfo.getUin()+"_"+e.getAttribute("_width");var i=PAGE_CACHE.get(t);if(!i){i=QZBlog.Util.PortraitManager.getPortraitUrl(QZBlog.Logic.SpaceHostInfo.getUin(),e.getAttribute("_width"));PAGE_CACHE.add(t,i)}if(!i){return}e.src=i;var a=QZBlog.Logic.SpaceHostInfo.isOwnerMode()?"我的头像":"主人头像";e.setAttribute("alt",a);e.title=a})},updatePageView:function(e){$("app_mod_blog").style.display="";$("app_mod").style.display="none";this.updateAvatar();this.updateBasicPageView();if($e("span[rel=total-blog-count]").elements[0]){$e("span[rel=total-blog-count]").elements[0].innerHTML=e.totalnum||0}if(e&&e.hostFlag!=undefined){this.toggleViewMode(e.hostFlag)}if(!e||!e.list.length){
$("list-toolbar").style.display="none"}else{$("list-toolbar").style.display="";var t,i,a,o,n,r,l;for(t=0,i=e.list.length;t<i;t++){a=e.list[t];o=a.blogId;n=this.getBlogLabel(a);if(n){l=$("blog-label-"+o);if(l){l.innerHTML=n;l.style.display=""}}r=this.getBlogIcon(a);title=this.getBlogMediaTypeTitle(a);if(r){l=$("blog-icon-"+o);if(l){l.title=title;l.className=r;l.style.display=""}}if(this.getEffectBit(a,29)&&this.isOwner){l=$("blog-priicon-"+o);if(l){l.className="icon icon_lock";l.style.display=""}}}}this.updateBlogOrderSelector(this.currentFilter.sortType);this.cleanMainNavHoverEffect();var s=$e("#main-nav a[rel=blog-list-link]:first").elements[0];QZFL.css.addClassName(s,"selected")},resizeFrame:function(){setTimeout(function(){frameElement.height=Math.max(document.body.scrollHeight,document.body.offsetHeight)+"px";frameElement.parentNode.style.height="auto"},100)},getBlogIcon:function(e){var t={0:"icon icon_img",13:"icon icon_video"};for(var i in t){if(this.getEffectBit(e,i)){
return t[i]}}return null},getBlogMediaTypeTitle:function(e){var t={0:"日志中包含图片",13:"日志中包含视频"};for(var i in t){if(this.getEffectBit(e,i)){return t[i]}}return null},getBlogLabel:function(e){var t=[["8","审核不通过"],["22","审核中"],["4","顶"],["21","荐"],["3","转"],["28","转"],["35","转"],["36","转"]];var i=function(e){for(var i=0;i<t.length;i++){if(t[i][0]==e){return t[i][1]}}};var a="";for(var o=0;o<t.length;o++){var n=t[o][0];if(n==22){continue}if(this.getEffectBit(e,n)){a+='<span class="'+(n==3||n==28||n==35||n==36?"c_tx3":"c_tx4")+'" rel="blog-detail-link" blogid="'+e.blogId+'"'+">["+t[o][1]+"]</span>";if(n==8){break}}}return a},getEffectBit:function(e,t){if(t<0||t>63){throw new Error("nBit param error")}if(t<32){return e.effect1&1<<t}else if(t<64){return e.effect2&1<<t}},switchToBlogList:function(){QZFL.widget.bubble.hideAll();$("app_mod_blog").style.display="";$("app_mod").style.display="none";this.initSideCateNavHoverEffect();try{parent.BlogListNavigator.setCurrentDate(null)
;parent.BlogListNavigator.setCurrentCate("");if(BlogList.Calendar){BlogList.Calendar.showDateInfo()}if(BlogList.Category){BlogList.Category.disHighLightAllCate();BlogList.Category.showCategoryList()}}catch(e){}this.showPage({cateName:null,cateHex:null,startTime:null,endTime:null,page:1})},bindPageEvent:function(){var e=this;QZBlog.Logic.batchDelegate({"a[rel=blog-list-link]":function(){e.switchToBlogList()},"a[rel=switch-abstract-mode]":function(){e.toggleViewMode(parent.BlogListViewType["DIGEST"])},"a[rel=switch-list-mode]":function(){e.toggleViewMode(parent.BlogListViewType["CLASSIC"])},"a[rel=blog-detail-link]":function(t){e.showBlogDetail(t);top.window.g_point0_2=(new Date).getTime()},"a[rel=blog-list-prev-page-link]":function(){var t=e.currentFilter.page-1;t=t>0?t:1;e.showPage({page:t})},"a[rel=current-space-link]":function(){QZONE.FP._t.location.href=QZBlog.Logic.SpaceHostInfo.getSpaceUrl()}})
;QZFL.event.addEvent(document.body,"click",QZFL.object.bind(this,this.toggleBlogOrderSelector))},cleanMainNavHoverEffect:function(){$e("#main-nav>li>a").removeClass("selected");$e("div.mod_tabs_other a").removeClass("current")},cleanSideCateNavHoverEffect:function(){var e=$e("#cateListContainer li a").elements;for(var t=0;t<e.length;t++){var i=e[t];if(QZFL.css.hasClassName(i,"c_tx2")){QZFL.css.replaceClassName(i,"c_tx2","c_tx")}}},initSideCateNavHoverEffect:function(){var e=$e("#cateListContainer li a").elements;for(var t=0;t<e.length;t++){var i=e[t];if(QZFL.css.hasClassName(i,"c_tx2")){QZFL.css.replaceClassName(i,"c_tx2","c_tx")}}if(e.length>0){var i=e[0];if(QZFL.css.hasClassName(i,"c_tx")){QZFL.css.replaceClassName(i,"c_tx","c_tx2")}}},showPagination:function(e,t,i){e=parseInt(e,10)||0;t=parseInt(t,10)||0;i=parseInt(i,10)||0;if(e<1||t<1||i<1||t<=i){$("pagination").style.display="none";return}$("pagination").style.display="";var a=Math.ceil(t/i)
;QZBlog.Util.PageIndexManager.init([$("pagination")],a,e,QZFL.object.bind(this,function(e){this.showPage({page:e});if(this.currentFilter.viewmode==parent.BlogListViewType["DIGEST"]){QZBlog.Util.jumpTop(true)}}))},showPage:function(e){var t=this;this.getPageData(e,function(i){if(e.page>1&&!i.list.length){e.page-=1;t.showPage(e);return}t.data=i;if(t.inited||QZBlog.Logic.isSeoPage&&window.BLOGLIST_SEO_RENDED){t.renderList(i)}else{t._toggleViewModeUI(t.currentFilter.viewmode);QZBlog.Util.Statistic.addSpeedPoint(5);QZBlog.Util.Statistic.sendSpeedStatistic(112,6)}t.loadReadNum(i);t.updatePageView(i);try{parent.BlogListNavigator.setSortType(t.currentFilter.sortType)}catch(e){}var a=t.currentFilter.page||1;t.showPagination(a,i.totalNum,t.Config.pageSize[t.currentFilter.viewmode]);t.fireEvent("showpage",i);e.catalog="list";PAGE_ROUTER.clean().set(e);QZBlog.Util.Statistic.sendPV("showlist");if(!t.isOwner){QZBlog.Util.Statistic.sendPV("showlist.guest")}})},toggleViewMode:function(e){
if(!this.isOwner){parent["BLOG_LIST_VIEW_MODE_"+QZBlog.Logic.SpaceHostInfo.getUin()]=e}this._toggleViewModeUI(e);if(e==this.currentFilter.viewmode){return}var t;if(typeof e=="undefined"||e!=parent.BlogListViewType["DIGEST"]&&e!=parent.BlogListViewType["CLASSIC"]){t=this.currentFilter.viewmode==parent.BlogListViewType["DIGEST"]?parent.BlogListViewType["CLASSIC"]:parent.BlogListViewType["DIGEST"]}else{t=e}this.showPage({viewmode:t});if(this.isOwner){this.saveViewMode(t)}this.fireEvent("toggleviewmode",t)},_toggleViewModeUI:function(e){var t=QZBlog.Logic.SpaceHostInfo.getLoginUin();parent.g_oBlogSettingInfoMgr.setListMode(t,e);$e("a[rel=switch-abstract-mode]").elements[0].style.display=e==1?"none":"";$e("a[rel=switch-list-mode]").elements[0].style.display=e==0?"none":""},toggleBlogOrderSelector:function(e){var t=QZFL.event.getTarget(e);var i=$("order-by-sel");var a=$("order-by-mnu");var o=this;if(a.style.display=="none"&&(t==i||t.parentNode==i)){i.className="bor2 select_order c_tx"
;a.style.display="";var n=[0,0];var r=QZFL.dom.searchChain(a,"parentNode",function(e){if(QZFL.dom.getStyle(e,"position")=="relative"&&e.tagName!="BODY"){return true}});if(r){n=QZFL.dom.getXY(r)}var l=QZFL.dom.getSize(i);var s=QZFL.dom.getXY(i);a.style.top=s[1]+l[1]-n[1]+"px";a.style.left=s[0]-n[0]+"px";if(!a.getAttribute("binded")){$e("a",a).bind("click",function(){var e=parseInt(this.getAttribute("val"),10);if(e!=o.currentFilter.sortType){o.showPage({sortType:e,page:1})}QZFL.event.preventDefault();return false});a.setAttribute("binded","1")}}else{i.className="c_tx";a.style.display="none"}},updateBlogOrderSelector:function(e){var t={0:["发表时间","按发表时间由新到旧排序"],1:["评论时间","按最新评论时间由新到旧排序"],3:["最新修改","按最后修改时间由新到旧排序"],4:["评论数目","按评论数目由多到少排序"]};e=parseInt(e,10)||0;$("order-by-sel").innerHTML=t[e][0]+'<span class="mod_arr"></span>';$("order-by-sel").title=t[e][1];$e("#order-by-mnu a").each(function(t){t.parentNode.style.display=t.getAttribute("val")==e?"none":""})},saveViewMode:function(e,t){
var i="titlelist_v="+(e+1);QZBlog.Logic.setBlogSetting(i,function(){parent.g_oBlogSettingInfoMgr.setListMode(QZBlog.Logic.SpaceHostInfo.getLoginUin(),e)},true)},loadReadNum:function(e){var t=[],i,a=false,o=this;for(var n=0;n<e.list.length;n++){var r=e.list[n].blogId;t.push(r);if(!a){var l=PAGE_CACHE.get("blog_read_num_"+r);if(l!==null){if(!i){i={}}i[r]=l}else{a=true}}}var s=function(e){for(var t in e){var i=e[t];if($("view-cnt-"+t)){$("view-cnt-"+t).innerHTML=i>Math.pow(10,6)?"999999+":i;if(o.currentFilter.viewmode==0){if(!QZONE.FP.getQzoneConfig("isOwner")&&QZONE.FP.getUserBitmap(36)){$("view-cnt-"+t).parentNode.title="阅读:"+i}else{$("view-cnt-"+t).parentNode.title="评论:"+$("reply-cnt-"+t).getAttribute("cnt")+"/阅读:"+i}}}if(!parent.g_XDoc){parent.g_XDoc={}}if(!parent.g_XDoc["blogCommentCount"]){parent.g_XDoc["blogCommentCount"]={}}if(!parent.g_XDoc["blogCommentCount"][t]){parent.g_XDoc["blogCommentCount"][t]={}}parent.g_XDoc["blogCommentCount"][t].read=i}};if(a){
QZBlog.Logic.getBlogViewInfo(t,QZFL.object.bind(this,function(e){var t=-1;var i=e.data;var a={};for(var n=0;n<i.itemList.length;++n){var t=i.itemList[n].id;var r=o.getBlog(t);console.log("阅读数：评论数",i.itemList[n].read,r.getCommentCnt());a[t]=Math.max(i.itemList[n].read,r.getCommentCnt());PAGE_CACHE.add("blog_read_num_"+t,a[t],this.Config.blogReadInfoCacheTime)}s(a)}))}else{s(i)}},renderList:function(e){var t="";try{if(e&&e.code==0&&e.list.length){e.isOwner=this.isOwner;t=tmpl(this.currentFilter.viewmode==parent.BlogListViewType["CLASSIC"]?LIST_PAGE_TPL:LIST_ABSTRACT_TPL,e)}else if(e&&e.code==0&&!e.list.length){if((this.currentFilter.cateHex||this.currentFilter.cateName)&&this.currentFilter.page==1){var i="";if(this.currentFilter.cateName){i=this.currentFilter.cateName}else{var a=INIT_PAGE_DATA.cateInfo.categorylist;for(var o=0;o<a.length;o++){if(a[o].catehex==this.currentFilter.cateHex){i=a[o].category;break}}}t=PAGE_DATA_EMPTY_CATE_TPL.replace(/category=""/i,'category="'+i+'"')
}else if(this.currentFilter.page>1){setTimeout(QZFL.object.bind(this,function(){this.showPage({page:this.currentFilter.page-1})}),100)}else{t=PAGE_DATA_EMPTY_TPL}}else{t=PAGE_DATA_ERROR_TPL}}catch(e){t=PAGE_DATA_ERROR_TPL}$("page-container-blog").innerHTML=t},getPageData:function(e,t,i){this.currentFilter=QZFL.object.extend(this.currentFilter,e);var a={verbose:0,blogType:0,cateHex:this.currentFilter.cateHex||"",cateName:(this.currentFilter.cateName||"").toRealStr().URLencode(),pos:(this.currentFilter.page-1)*this.Config.pageSize[this.currentFilter.viewmode],num:this.Config.pageSize[this.currentFilter.viewmode],sortType:this.currentFilter.sortType,absType:this.currentFilter.viewmode,statYear:this.currentFilter.statYear,startTime:this.currentFilter.startTime,endTime:this.currentFilter.endTime};var o="";for(var n in a){if(a[n]){o+=n+"_"+a[n]+"__"}}var r=PAGE_CACHE.get(o);if(r){t(r)}else if(!this.inited&&!QZBlog.Logic.isSeoPage){t(INIT_PAGE_DATA)
;PAGE_CACHE.add(o,INIT_PAGE_DATA,this.Config.blogListCacheTime)}else if(QZBlog.Logic.isSeoPage&&!window.BLOGLIST_SEO_RENDED){t(INIT_PAGE_DATA);window.BLOGLIST_SEO_RENDED=true}else{var l=this;var s=function(e){if(e&&e.data){var t=e.data;t.code=e.code;for(var i=0;i<t.list.length;i++){var a=t.list[i];var o=QZFL.string.getRealLen(a.title)*2;t.list[i]["abstract"]=l.fixAbstract(a["abstract"]);t.list[i].shorttitle=a.title;t.list[i].shortpubtime=l.long2shorttime(a.pubTime);var n={page:parseInt(getParameter("page"),10)||1};t.list[i].blogurl="http://"+(QZBlog.Logic.isInPengyou?"baseapp.pengyou.com":"user.qzone.qq.com")+"/"+QZBlog.Logic.SpaceHostInfo.getUin()+"/blog/"+a.blogId}return t}};var g=QZBlog.CGI_URL.get("get_abs");var c=function(){return QZBlog.Util.getNewBlogListUrlData(a)};var d=new QZBlog.Util.NetRequest({url:g,data:c,method:"get",uniqueCGI:true,maxRequestInterval:0,domainReverted:1});d.onSuccess=function(e){if(e.data&&e.code==0){var a=s(e)
;PAGE_CACHE.add(o,a,l.Config.blogListCacheTime);t&&t(a)}else{i&&i(e)}};d.send()}},jumpToUrl:function(e){try{if(top.g_iframeUser){var t=top.g_cgidomain+".qzone.qq.com";if(e.indexOf("//"+t)==-1){if(e.indexOf("//qzs.qq.com")>-1){e=e.replace("qzs.qq.com",t+"/proxy/domain/qzs.qq.com")}else{e=e.replace("/qzone/","//"+t+"/proxy/domain/qzs.qq.com/qzone/")}}if(e.indexOf("g_iframeUser=1")==-1){e+="&g_iframeUser=1"}}}catch(e){}setTimeout(function(){location.href=e},0)},getBlog:function(e,t){if(e>-1){for(var i=0;i<this.data.list.length;i++){if(this.data.list[i].blogId==e){t=this.data.list[i]}}}if(!t){return}var a=new parent.BlogRightInfo;a.setType(t.artype);var o=t.arUins&&t.arUins.length?t.arUins.split(","):null;if(o){var n=[];for(var i=0;i<o.length;i++){var r=new parent.UserInfo;r.setUin(o[i]);n.push(r)}}a.setUserList(n);var l=new parent.BlogInfo;l.setCategoryName(t.cate);l.setID(e);l.setEffect(t.effect1);l.setEffect2(t.effect2);l.setCommentCnt(t.commentNum);l.setType(t.blogType)
;l.setRightInfo(a);l.isPhotoBlog=t.blogType==1;l.isTemplateBlog=t.blogType==2;l.isGridBlog=!!l.getEffectBit(52);return l}};BlogList=QZFL.object.extend(BlogList,PAGE_EVENT);var e=setTimeout(function(){if($("page-error")){$("page-error").style.display=""}QZBlog.Util.Statistic.sendPV("showlist_timeout_5s")},5e3);var t=setTimeout(function(){QZBlog.Util.Statistic.sendPV("showlist_timeout_10s")},1e4);BlogListReporter.markPoint(6);var i=function(){setTimeout(function(){BlogListReporter.markPoint(7);BlogList.init();if(INIT_PAGE_DATA&&INIT_PAGE_DATA.cateInfo){parent.g_oCateInfoMgr.convertJsonObject(INIT_PAGE_DATA.cateInfo)}BlogListReporter.markPoint(8)},0);if($("page-error")){$("page-error").style.display="none"}clearTimeout(e);clearTimeout(t);try{var i=QZONE.FP.getStatPackage().valueStat(400678,2,1,{reportRate:1,duration:0})}catch(e){}if(QZONE.FP.isInteractZone()){QZFL.pingSender("http://p1.qzone.qq.com/fcg-bin/page_pv_uv_report?r_type=4&pageuin="+QZBlog.Logic.SpaceHostInfo.getUin())}}
;var a=false;var o=null;var n=function(){var e=$("page-container-blog");if(PAGE_CATALOG=="list"){if(!INIT_PAGE_DATA||INIT_PAGE_DATA.code!=0){if(INIT_PAGE_DATA.code==-204||INIT_PAGE_DATA.error=="no right"){e.innerHTML=PAGE_ACCESS_ERROR;QZFL.event.addEvent($("returnMySpace"),"click",function(){QZONE.FP._t.location.href=QZBlog.Util.getSpaceUrl(QZBlog.Util.getLoginUin())})}else if(INIT_PAGE_DATA.error=="login"){e.innerHTML=PAGE_DATA_LOGIN_TPL}else{e.innerHTML=PAGE_DATA_ERROR_TPL}}else if(INIT_PAGE_DATA.list.length){var t=parseInt(INIT_PAGE_DATA.hostFlag,10);e.innerHTML=tmpl(t==1?LIST_ABSTRACT_TPL:LIST_PAGE_TPL,INIT_PAGE_DATA)}else if(INIT_PAGE_DATA.list.length==0&&getParameter("cate")){e.innerHTML=PAGE_DATA_EMPTY_CATE_TPL.replace(/category=""/i,'category="'+getParameter("cate")+'"')}else{e.innerHTML=PAGE_DATA_EMPTY_TPL}$("rightCateArea").innerHTML=tmpl(CATEGORY_TPL,INIT_PAGE_DATA);$("app_mod_blog").style.display=""}};var r=function(){if(parent.BlogListNavigator){console.log("basic.js已加载")
;i()}else{parent.QZFL.imports("http://"+parent.siDomain+"/qzone/newblog/v5/script/basic.js",i)}};var l=function(e){if(a){return}clearTimeout(o);BlogListReporter.markPoint(4);if(e&&e.data&&e.code==0){INIT_PAGE_DATA=QZFL.object.extend(INIT_PAGE_DATA,e.data);INIT_PAGE_DATA.code=e.code;if(!!INIT_PAGE_DATA.month_num){INIT_PAGE_DATA.year=curYear}if(INIT_PAGE_DATA.list){INIT_PAGE_DATA.isOwner=QZBlog.Logic.SpaceHostInfo.isOwnerMode();for(var t=0;t<INIT_PAGE_DATA.list.length;t++){var i=INIT_PAGE_DATA.list[t];var l=QZFL.string.getRealLen(i.title)*2;INIT_PAGE_DATA.list[t]["abstract"]=_fixAbstract(i["abstract"]);INIT_PAGE_DATA.list[t].shorttitle=i.title;INIT_PAGE_DATA.list[t].shortpubtime=_long2shorttime(i.pubTime);INIT_PAGE_DATA.list[t].blogurl="http://"+(QZBlog.Logic.isInPengyou?"baseapp.pengyou.com":"user.qzone.qq.com")+"/"+QZBlog.Logic.SpaceHostInfo.getUin()+"/blog/"+i.blogId}}if(BlogList.Manager){BlogList.Manager.cateData=INIT_PAGE_DATA.cateInfo}}else if(e.code==-3e3){
INIT_PAGE_DATA.error="login";QZONE.FP.showLoginBox(null,function(){location.reload()})}else if(e.code==-4002){QZONE.FP.showMsgbox(e.message,1,2e3);INIT_PAGE_DATA.error="login";QZONE.FP.showLoginBox(null,function(){location.reload()})}else if(e.code==-4009){QZONE.FP.showMsgbox(e.message,1,2e3);INIT_PAGE_DATA.error="no right"}n(INIT_PAGE_DATA);r()};var s=parent["BLOG_LIST_VIEW_MODE_"+QZBlog.Logic.SpaceHostInfo.getUin()]||0;window.currentDate||(window.currentDate={});var g;try{g=QZBlog.CGI_URL.get("get_abs")+"?"+QZBlog.Util.buildParam(QZBlog.Util.getNewBlogListUrlData({absType:!QZBlog.Logic.SpaceHostInfo.isOwnerMode()&&typeof s!=undefined?s:null,verbose:currentDate["year"]&&currentDate["month"]?0:1,sortType:sortType||0,reqInfo:requestParam,statYear:curYear,startTime:spanTime["start"]||null,endTime:spanTime["end"]||null,cateName:currentCate,cateHex:currentCatehex,pos:(pageIndex-1)*pageSize,num:pageSize}))}catch(e){}if(PAGE_CATALOG=="list"&&g){console.log("列表页，走域名收归逻辑")
;var c=QZONE.FP._t.QZFL.JSONGetter||window.QZFL.JSONGetter;var d=new QZFL.JSONGetter(g,void 0,null,"gb2312");d.onSuccess=function(e){l(e);window.QZONE&&QZONE.FP&&QZONE.FP._t&&QZONE.FP._t.TCISD&&QZONE.FP._t.TCISD.haboStat({commandid:this._uri,stime:this.endTime-this.startTime,resultcode:0,touin:QZONE.FP._t.g_iLoginUin||0,frequency:1})};d.onTimeout=function(){n();r();window.QZONE&&QZONE.FP&&QZONE.FP._t&&QZONE.FP._t.TCISD&&QZONE.FP._t.TCISD.haboStat({commandid:this._uri,stime:this.endTime-this.startTime,resultcode:998,touin:QZONE.FP._t.g_iLoginUin||0,frequency:1})};d.onError=function(){n();r();window.QZONE&&QZONE.FP&&QZONE.FP._t&&QZONE.FP._t.TCISD&&QZONE.FP._t.TCISD.haboStat({commandid:this._uri,stime:this.endTime-this.startTime,resultcode:999,touin:QZONE.FP._t.g_iLoginUin||0,frequency:1})};d.send("_Callback");BlogListReporter.markPoint(3)}else{BlogListReporter.markPoint(12);r()}})();(function(e,t,i){e.Calendar={init:function(){if(!$("calendarTemplate")){return}var t=this
;e.triggerEvent("refreshCurrentPage",function(){parent.g_oCateInfoMgr.clear();t.showDateInfo()});e.triggerEvent("coreinited",function(){var e=t.getCurrentYear();if(INIT_PAGE_DATA&&!!INIT_PAGE_DATA.month_num){if(INIT_PAGE_DATA.year==e&&!parent.g_oCateInfoMgr.getDateInfo(e))t.fillInitCalendar()}if(typeof t._templateHTML=="undefined"){t._templateHTML=$("calendarTemplate").innerHTML}t.showDateInfo();BlogListReporter.markPoint(9)})},fillInitCalendar:function(){var e=this.getCurrentYear();var t={month_num:INIT_PAGE_DATA["month_num"],year:e};t["year"]=e;var i=new parent.BlogDateInfo;i.convertJsonObject(t);parent.g_oCateInfoMgr.setDateInfo(e,i)},getCurrentYear:function(e){var t=new Date(parent.g_NowTime*1e3);var i=t.getYear()<1900?1900+t.getYear():t.getYear();var a=this;if(!e){if(!!parent.BlogListNavigator){if(parent.BlogListNavigator.getCurrentDate()&&typeof parent.BlogListNavigator.getCurrentDate()["year"]!="undefined"){e=parent.BlogListNavigator.getCurrentDate()["year"]}else{e=i}}else{e=i}}
if(e>i||e<1970){return i}return e},showDateInfo:function(e,t,i){var a=this;e=a.getCurrentYear(e);QZBlog.Logic.getDateInfo(e,function(i){if(!i){return}var o=-1;if(t){o=t;parent.BlogListNavigator.setCurrentDate({year:e,month:t})}else{var n=parent.BlogListNavigator.getCurrentDate();if(n&&typeof n["month"]!="undefined"&&n["year"]==e){o=o>=0?o:n["month"]}}var r={};r.curMonth=o;r.curYear=e;r.prevYear=e-1;r.nextYear=e+1;r.curTotalNum=i.getTotalNum();r.list=[];for(var l=0;l<12;++l){r.list.push(parseInt(i.getNum(l+1),10))}$("calendarArea").innerHTML=tmpl(a._templateHTML,{dateInfo:r})},i)},refreshCalendar:function(){var e=parent.BlogListNavigator.getCurrentDate();if(e){var t=e.year,i=e.month;var a=new parent.BlogDateInfo;parent.g_oCateInfoMgr.setDateInfo(t,a);parent.BlogListNavigator.setCurrentDate(a);this.showDateInfo(t,i,true)}else{this.showDateInfo(null,null,true)}},selectDate:function(t,i){e.Category.disHighLightAllCate();parent.BlogListNavigator.clear()
;parent.BlogListNavigator.setCurrentCate("");parent.BlogListNavigator.setCurrentCatehex("");parent.BlogListNavigator.setCurrentDate({year:t,month:i});this.showDateInfo(t);var a=null;var o=null;var n=parent.BlogListNavigator.getCurrentDate();if(n&&typeof n["year"]!="undefined"&&typeof n["month"]!="undefined"){var r=QZBlog.Util.getMonthSpanTime(n["year"],n["month"]);a=r["start"];o=r["end"]}var l={cateName:null,cateHex:null,statYear:n["year"],startTime:a,endTime:o,page:1,catalog:"list"};e.showPage(l);PAGE_ROUTER.clean().set(l)}};e.Calendar.init()})(BlogList,window);(function(e,t,i){e.Category={init:function(){var t=this;e.addEvent("cateupdate",function(){t.showCategoryList(true)});e.triggerEvent("coreinited",function(){t.bindPageEvent();try{var i=INIT_PAGE_DATA.cateInfo;if(i&&!!i.categoryList.length){parent.g_oCateInfoMgr.convertJsonObject(i);e.fireEvent("sidecaterendered")}else{t.showCategoryList()}}catch(e){}if(!e.currentFilter.starttime&&!e.currentFilter.endtime){}else{
t.disHighLightAllCate()}})},toggleMoreCateNavPanel:function(e){var t=$e("#cateListContainer .sort_more a:first").elements[0];if(!t){return}var a=e===i?$("cateListMore").style.display=="none":!!e;if(a){$e("span",t).elements[0].className="mod_arr arr_t";QZFL.css.addClassName(t,"bg bor3");QZFL.css.addClassName(t.parentNode,"drop_list_show")}else{$e("span",t).elements[0].className="mod_arr arr_r";QZFL.css.removeClassName(t,"bg bor3");QZFL.css.removeClassName(t.parentNode,"drop_list_show")}$("cateListMore").style.display=a?"":"none"},showCategoryList:function(t){var i=this;QZBlog.Logic.getCategoryInfo(function(t){INIT_PAGE_DATA.cateInfo=t.data.cateInfo;if(e.Manager){e.Manager.cateData=t.data.cateInfo}$("rightCateArea").innerHTML=tmpl(CATEGORY_TPL,INIT_PAGE_DATA);e.updateBasicPageView();i.highLightCate(e.currentFilter.cateName,e.currentFilter.cateHex);e.fireEvent("sidecaterendered")},QZFL.emptyFn,t)},highLightCate:function(e,t){if(!$("cateListContainer")){return}this.disHighLightAllCate()
;var i=$("cateListContainer").getElementsByTagName("a");for(var a=0;a<i.length;++a){if(e&&i[a].getAttribute("cate")==e||t&&i[a].getAttribute("catehex")==t){QZFL.css.addClassName(i[a],"c_tx2");QZFL.css.addClassName(i[a],"bg2");QZFL.css.removeClassName(i[a],"c_tx");if(i[a].getAttribute("inmorenav")){this.toggleMoreCateNavPanel(true)}break}else{QZFL.css.addClassName(i[a],"c_tx");QZFL.css.removeClassName(i[a],"c_tx2");QZFL.css.removeClassName(i[a],"bg2")}}if(!e&&!t){QZFL.css.addClassName(i[0],"c_tx2");QZFL.css.addClassName(i[0],"bg2");QZFL.css.removeClassName(i[0],"c_tx")}},disHighLightAllCate:function(){if(!$("cateListContainer")){return}var e=$("cateListContainer").getElementsByTagName("a");for(var t=0;t<e.length;++t){QZONE.css.removeClassName(e[t],"c_tx2");QZONE.css.removeClassName(e[t],"bg2");QZONE.css.addClassName(e[t],"c_tx");QZONE.css.removeClassName(QZFL.dom.getLastChild(e[t].parentNode.parentNode),"c_tx2")}},selectCate:function(t,i){if(typeof i=="undefined"){i=""}
parent.BlogListNavigator.setCurrentDate(null);parent.BlogListNavigator.setCurrentCate(t);parent.BlogListNavigator.setCurrentCatehex(i);if(e.Calendar){e.Calendar.showDateInfo()}this.highLightCate(t,i);e.showPage({cateName:t,cateHex:i||null,startTime:null,endTime:null,page:1});e.fireEvent("category_select")},bindPageEvent:function(){var e=this;QZBlog.Logic.batchDelegate({"a[rel=category-select-link]":function(t){var i=t.getAttribute("cate");var a=t.getAttribute("catehex");e.selectCate(i,a)},"a[rel=category-toggle-more-panel]":function(){e.toggleMoreCateNavPanel()}});QZFL.event.addEvent(document.body,"click",function(t){var i=QZFL.event.getTarget(t);var a=i.getAttribute("rel");if(a!="category-select-link"&&a!="category-toggle-more-panel"){if(i&&i!=$("cateListMore")&&a!="category-toggle-more-panel"&&!QZFL.dom.isAncestor($("cateListMore"),i)){e.toggleMoreCateNavPanel(false)}}})}};e.Category.init()})(BlogList,window);(function(e,t,i){e.TCISD={URL:"/BlogList",init:function(){var t={
"write-blog-link":"Add.blog","write-photoblog-link":"Add.photoblog","write-gridblog-link":"Add.gridblog","write-templateblog-link":"Add.moban","switch-abstract-mode":"Set.Summarymode","switch-list-mode":"Set.Listmode","switch-batch-mode":"Volume_Set","list-more-menu-link":"Options","blog-edit-link":"Editblog","blog-report-link":"options.Report","blog-delete-link":"options.Delete","blog-right-setting-link":"options.Permissions_Set","blog-category-modify-link":"options.Editcatalog","blog-set-top-link":"options.Top_Set","blog-recommend-link":"options.Recommendation","blog-convert-private-link":"options.To_Private","setting-link":"Management.Blog","blog-list-link":"Blog","draft-list-link":"Drafts","private-blog-link":"Private_Blog","recycle-list-link":"Recycle_Bin","friendblog-link":"Frinends_Blog","notepad-link":"Notepad","category-manage-link":"Catalog.Management","category-select-link":"Catalog.List","support-link":"support"};var a={1:"Listmode.",2:"Summarymode."}
;QZFL.event.addEvent(document.body,"mousedown",QZFL.object.bind(this,function(o){var n=QZFL.event.getTarget(o);var r=n.getAttribute("rel");var l="";if(n&&n.textContent!=i){l=n.textContent}else if(n&&n.innerText!=i){l=n.innerText}var s=n.id;var g=n.parentNode;var c=e.currentFilter.viewmode;if(n&&r&&t[r]){if(r=="blog-detail-link"){if(l&&l=="查看全文"&&g&&QZFL.css.hasClassName(g,"left")){QZBlog.Logic.TCISDClick("Summarymode.readblog",e.TCISD.URL)}else if(l&&l.indexOf("阅读")>=0&&g&&QZFL.css.hasClassName(g,"left")){QZBlog.Logic.TCISDClick("Summarymode.Read_count",e.TCISD.URL)}else if(l&&l.indexOf("评论")>=0&&g&&QZFL.css.hasClassName(g,"left")){QZBlog.Logic.TCISDClick("Summarymode.Comments_count",e.TCISD.URL)}else if(g&&QZFL.css.hasClassName(g,"mod_play")){QZBlog.Logic.TCISDClick("Summarymode.video",e.TCISD.URL)}else{var d=a[c]+t[r];QZBlog.Logic.TCISDClick(d,e.TCISD.URL)}}else if(r=="blog-edit-link"||r=="list-more-menu-link"){var d=a[c]+t[r];QZBlog.Logic.TCISDClick(d,e.TCISD.URL)}else{var d=t[r]
;QZBlog.Logic.TCISDClick(d,e.TCISD.URL)}}else if(n&&QZFL.css.hasClassName(n,"icon_img")){QZBlog.Logic.TCISDClick("Listmode.Photo",e.TCISD.URL)}else if(n&&QZFL.css.hasClassName(n,"icon_video")){QZBlog.Logic.TCISDClick("Listmode.Video",e.TCISD.URL)}else if(n&&l&&g&&QZFL.css.hasClassName(g,"mod_pagenav_count")){var u=/^[0-9]*[1-9][0-9]*$/i;if(u.test(l)&&QZFL.css.hasClassName(n,"c_tx")){QZBlog.Logic.TCISDClick("Pager.Page_Number",e.TCISD.URL)}}else if(n&&l&&g&&QZFL.css.hasClassName(g,"mod_pagenav_main")&&QZFL.css.hasClassName(n,"c_tx")){if(l=="上一页"){QZBlog.Logic.TCISDClick("Pager.Previous_Page",e.TCISD.URL)}else if(l=="下一页"){QZBlog.Logic.TCISDClick("Pager.Next_Page",e.TCISD.URL)}}else if(n&&l&&g&&QZFL.css.hasClassName(g,"mod_pagenav_turn")){if(l=="确 定"){QZBlog.Logic.TCISDClick("Pager.Goto_Page",e.TCISD.URL)}}}));QZBlog.Logic.TCISDClick.batchBind({"#app_mod_blog h4 a[rel=blog-detail-link]":"Title","#app_mod_blog .list_tit a[rel=blog-detail-link]":"Title",
"#app_mod_blog .mod_summary .img_show a[rel=blog-detail-link]":"Summarymode.Photo","#app_mod_blog .mod_summary .mod_video":"Summarymode.video","#app_mod_blog a[rel=blog-right-setting-link]":"Listmode.Permissions","#calendarArea a":"Category.Date","#importArea a":"ImportBlog","#auditHref a":"Audit","#blog_search_btn":"soso.Search","#order-by-sel":"Sort","#searchArea .mod_links a":"soso.tag","a[rel=ugc-blog-submit]":"Ugc.SubmitButton",".options a[rel=ugc-blog-edit]":"Ugc.OptionEditButton",".img_show a[rel=ugc-blog-edit]":"Ugc.ImageEditButton","a[rel=ugc-blog-delete]":"Ugc.DeleteButton","h4 a[rel=ugc-blog-edit]":"Ugc.TitleEdit","#acceptUgcTips":"shezhi.jieshou","#acceptUgcTipsLabel":"shezhi.jieshou","#denyUgcTips":"shezhi.bujieshou","#denyUgcTipsLabel":"shezhi.bujieshou"},{url:"/BlogList",prepare:true,eventType:"mousedown"});QZBlog.Logic.TCISDClick.batchBind({"a[static=button1]":"tj1","a[static=button2]":"tj2","a[static=button3]":"tj3","a[static=button4]":"tj4"},{url:"isd.qzonemall.blog",
prepare:true,eventType:"mousedown",domain:"mall.qzone.qq.com"})}};e.TCISD.init()})(BlogList,window);(function(e,t,i){e.Search={placeholder_str:"请输入关键字",search:function(e){if(typeof e=="undefined"){e=this.blog_search_text.value.trim();if(e==""||e==this.placeholder_str){this.blog_search_text.value=this.placeholder_str;this.blog_search_text.focus();return}}try{setTimeout(function(){QZONE.FP.Search(e,{entryid:64,type:"blog",appname:"日志",backurl:"/blog"})},10)}catch(e){}},initSearchInput:function(){this.blog_search_text=QZFL.dom.get("blog_search_text");this.blog_search_btn=QZFL.dom.get("blog_search_btn");this.blog_search_text.value=this.placeholder_str;QZFL.event.addEvent(this.blog_search_text,"focus",QZFL.event.bind(this,function(){if(this.blog_search_text.value==this.placeholder_str){this.blog_search_text.value="";QZFL.css.removeClassName(this.blog_search_text,"c_tx3")}QZFL.css.updateClassName(this.blog_search_text.parentNode,"bor2 bg","textinput_focus")}))
;QZFL.event.addEvent(this.blog_search_text,"blur",QZFL.event.bind(this,function(){if(this.blog_search_text.value.trim()==""){this.blog_search_text.value=this.placeholder_str;QZFL.css.addClassName(this.blog_search_text,"c_tx3")}QZFL.css.updateClassName(this.blog_search_text.parentNode,"textinput_focus","bor2 bg")}));QZFL.event.addEvent(this.blog_search_text,"keydown",QZFL.event.bind(this,function(e){var t=e.keyCode;if(t==13){this.search()}}));QZFL.event.addEvent(this.blog_search_btn,"click",QZFL.event.bind(this,function(){this.search();QZFL.event.preventDefault();return false}))},show:function(e){var t={};t.vipClass=QZBlog.Logic.SpaceHostInfo.isVipUser()?"":"none";t.ownerClass=QZBlog.Logic.SpaceHostInfo.isOwnerMode()?"":"none";t.ItemList=typeof e!="undefined"?e:[];$("searchArea").innerHTML=tmpl(this._templateHTML,{data:t});$("searchArea").style.display="";this.initSearchInput()},init:function(){var e=this;if(typeof e._templateHTML!="undefined"){return}
e._templateHTML=$("searchTemplate").innerHTML;this.show();BlogListReporter.markPoint(10)}};QZONE.FP.getSecondaryBitMapFlag(function(t,i){if(i){return}e.Search.init()},25,null,QZBlog.Logic.SpaceHostInfo.getUin())})(BlogList,window);(function(e,t,i){e.ShortCut={init:function(){this.bindShortcut()},_addKeyEvent:function(e,t,i,a){a=a||"keydown";var o=t.split("+");var n={ctrl:false,alt:false,shift:false};QZFL.object.each(o,function(e){e=e.toLowerCase();if(e=="ctrl"||e=="alt"||e=="shift"){n[e]=true}else if(e=="enter"){n.keyCode==13}else if(parseInt(e,10)>10){n.keyCode=parseInt(e,10)}else{n.keyCode=e.toUpperCase().charCodeAt(0)}});QZFL.event.addEvent(e,a,function(e){var a=QZFL.event.getTarget();if(n.ctrl!=e.ctrlKey||n.shift!=e.shiftKey||n.alt!=e.altKey||a.tagName=="INPUT"||a.tagName=="BUTTON"){return}if(n.keyCode==e.keyCode){QZBlog.Logic.TCISDClick("useshortcut."+t.replace("+","_"),"/BlogList");var o=i(e);if(o===false){QZFL.event.preventDefault();return false}}})},bindShortcut:function(){
var t=this;var i=function(){var e=$("listArea");if(!e||e.offsetHeight===0||e.offsetWidth===0||e.style.display=="none"){return[]}var t=e.getElementsByTagName("LI");var i=[];for(var a=0;a<t.length;a++){var o=t[a].getElementsByTagName("A")[0];if(o&&o.rel=="blog-detail-link"&&o.getAttribute("blogid")){i.push(o)}}if(!i.length){return[]}var n=$e("a:last",$("pagination")).elements[0];if(n){i.push(n)}return i};var a={p:function(){var e=i();if(!e.length){return}var a=null;if(t.lastNTag){for(var o=0;o<e.length;o++){if(e[o]==t.lastNTag){a=o>0?e[o-1]:null;break}}}if(!a){a=e[e.length-1]}t.lastNTag=a;a.focus()},n:function(){var e=i();if(!e.length){return}var a=null;if(t.lastNTag){for(var o=0;o<e.length;o++){if(e[o]==t.lastNTag){a=e[o+1]||null;break}}}if(!a){a=e[0]}t.lastNTag=a;a.focus()},188:function(){var t=$("listArea");if(!t||t.offsetHeight===0||t.offsetWidth===0||t.style.display=="none"){return}if(e.currentFilter.page>1){e.showPage({page:e.currentFilter.page-1})}},190:function(){
var t=$("listArea");if(!t||t.offsetHeight===0||t.offsetWidth===0||t.style.display=="none"){return}e.showPage({page:e.currentFilter.page+1})}};for(var o in a){this._addKeyEvent(document,o,a[o])}if(e.isOwner){if($("batchEditHref")){$("batchEditHref").title="批量管理[ctrl+a]"}$e("a[rel=write-blog-link]").each(function(e){e.title="写日志[alt+1]"});$e("a[rel=write-templateblog-link]").each(function(e){e.title="写模板日志[alt+2]"});$e("a[rel=write-gridblog-link]").each(function(e){e.title="写魔方日志[alt+3]"});var n={"alt+1":function(){PAGE_CACHE.clean();e.jumpToUrl(QZBlog.Util.getEditBlogUrl()+"?opener=refererurl&source=1&refererurl="+encodeURIComponent(location.href))},"alt+2":function(){PAGE_CACHE.clean();var t={refererurl:location.href,directJumpIn:1,source:2};e.jumpToUrl(QZBlog.Util.getEditTemplateBlogUrl(t));return},"alt+3":function(){PAGE_CACHE.clean();e.jumpToUrl(QZBlog.Util.getEditGridBlogUrl({refererurl:location.href},3))},"ctrl+1":function(){e.switchToBlogList()},"ctrl+2":function(){
e.Manager.lazyLoad("bloglist.privateblog.js","BlogList.PrivateBlog",function(){PAGE_ROUTER.clean().set("catalog","private")})},"ctrl+3":function(){e.Manager.lazyLoad("bloglist.ugcblog.js","BlogList.UgcBlog",function(){PAGE_ROUTER.clean().set("catalog","ugc")})},"ctrl+4":function(){QZBlog.Util.Statistic.sendPV("notepad_click","rizhi.qzone.qq.com");try{parent.BlogListNavigator.setCurrentDate()}catch(e){}e.jumpToUrl("/qzone/newblog/v5/notepad/notepad.html")},"ctrl+a":function(){var t=$("batchEditHref");if(!t||t.offsetWidth===0&&t.offsetHeight===0||t.style.display=="none"){return}if(e.Manager.isBatchView){var i=$e("*[rel=batch-check-all]").elements[0];var a=!i.checked;i.checked=a;$e("#page-container-blog input[rel=batch-blog-select]").each(function(e){e.checked=a})}else{var o=$e("*[rel=switch-batch-mode]").elements[0];e.Manager.toggleBatchView(o)}return false},46:function(){},46:function(){}};for(var o in n){this._addKeyEvent(document,o,n[o])}if(!getParameter("nocontext")){
QZFL.event.addEvent(document.body,"contextmenu",function(e){var i=QZFL.event.getTarget(e);var a=QZFL.event.mouseX(e);var o=QZFL.event.mouseY(e);if(QZFL.dom.isAncestor($("listArea"),i)&&i.getAttribute("rel")=="blog-detail-link"&&i.parentNode.tagName=="A"&&i.tagName!="IMG"){t.toggleBlogOptionMenu(i.getAttribute("blogid"),a,o);QZFL.event.preventDefault();return false}else{t.toggleBlogOptionMenu()}});QZFL.event.addEvent(document.body,"click",function(){t.toggleBlogOptionMenu()})}}},toggleBlogOptionMenu:function(t,i,a){if(!this.blogOptionMenu){var o=QZBlog.Logic.isInPengyou?"display:none":"";this.blogOptionMenu=document.createElement("DIV");QZFL.css.insertStyleSheet(null,".op_more_mouse li a {text-align:left; padding-left:8px;}");document.body.appendChild(this.blogOptionMenu);this.blogOptionMenu.className="op_more op_more_mouse"
;this.blogOptionMenu.innerHTML=['<ul class="bor2 bg">','<li><a href="javascript:;" rel="blog-edit-link" title="编辑日志" class="bg3_hover">编辑</a></li>','<li><a href="javascript:;" rel="blog-delete-link" title="删除该日志" class="bg3_hover">删除日志</a></li>','<li style="',o,'"><a href="javascript:;" rel="blog-right-setting-link" title="日志权限设置" class="bg3_hover">设置权限</a></li>','<li><a href="javascript:;" rel="blog-category-modify-link" title="修改日志分类" class="bg3_hover">修改分类</a></li>','<li style="',o,'"><a href="javascript:;" rel="blog-set-top-link" title="设置该日志置顶" class="bg3_hover">设为置顶</a></li>','<li><a href="javascript:;" rel="blog-convert-private-link" title="转为私密日志" class="bg3_hover">转为私密日志</a></li>',"</ul>"].join("");QZFL.event.addEvent(this.blogOptionMenu,"click",function(){QZBlog.Logic.TCISDClick("contextmenu.click","/BlogList")})}this.blogOptionMenu.style.display=t?"":"none";if(t){QZBlog.Logic.TCISDClick("contextmenu.show","/BlogList");$e("a",this.blogOptionMenu).each(function(e){
e.setAttribute("blogid",t)});var n=e.getBlog(t);$e("a[rel=blog-set-top-link]",this.blogOptionMenu).setHtml(n.getTopFlag()?"取消置顶":"设为置顶");if(n.getEffectBit(52)){$e("a[rel=blog-convert-private-link]",this.blogOptionMenu).each(function(e){e.parentNode.style.display="none"})}else{$e("a[rel=blog-convert-private-link]",this.blogOptionMenu).each(function(e){e.parentNode.style.display=""})}QZFL.dom.setStyle(this.blogOptionMenu,{left:i,top:a})}}};e.ShortCut.init()})(window.BlogList,window);BlogListReporter.markPoint(11);